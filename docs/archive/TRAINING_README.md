# –°–∏—Å—Ç–µ–º–∞ –¥–µ—Ç–µ–∫—Ü–∏–∏ –∞–Ω–æ–º–∞–ª–∏–π –¥–≤–∏–∂–µ–Ω–∏–π –º–ª–∞–¥–µ–Ω—Ü–µ–≤

Production-ready —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è —Ä–∞–Ω–Ω–µ–≥–æ –≤—ã—è–≤–ª–µ–Ω–∏—è –Ω–∞—Ä—É—à–µ–Ω–∏–π –º–æ—Ç–æ—Ä–∏–∫–∏ —É –º–ª–∞–¥–µ–Ω—Ü–µ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ RGB-–≤–∏–¥–µ–æ.

## üéØ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- ‚úÖ **–¢–û–õ–¨–ö–û RGB-–≤–∏–¥–µ–æ** - –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç 3D –¥–∞–Ω–Ω—ã–µ –∏ depth –∫–∞–Ω–∞–ª—ã
- ‚úÖ **–û–ë–£–ß–ï–ù–ò–ï –¢–û–õ–¨–ö–û –ù–ê GPU** - –≤—Å–µ –º–æ–¥–µ–ª–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞ CUDA —Å mixed precision
- ‚úÖ **–ù–ï–¢ –£–¢–ï–ß–ö–ò –î–ê–ù–ù–´–•** - —Å—Ç—Ä–æ–≥–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ train/val/test –ø–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—è–º
- ‚úÖ **–¢–û–õ–¨–ö–û –ù–û–†–ú–ê–õ–¨–ù–´–ï –î–ê–ù–ù–´–ï** - –æ–±—É—á–∞–µ—Ç—Å—è –Ω–∞ –¥–≤–∏–∂–µ–Ω–∏—è—Ö –∑–¥–æ—Ä–æ–≤—ã—Ö –º–ª–∞–¥–µ–Ω—Ü–µ–≤

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
RGB –≤–∏–¥–µ–æ ‚Üí MediaPipe (33 —Ç–æ—á–∫–∏) ‚Üí –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∞ ‚Üí LSTM –∞–≤—Ç–æ—ç–Ω–∫–æ–¥–µ—Ä ‚Üí –û—Ü–µ–Ω–∫–∞ –∞–Ω–æ–º–∞–ª–∏–∏
```

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

1. **Data Pipeline** (`utils/data_loader.py`) - –ó–∞–≥—Ä—É–∑–∫–∞ RGB –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ MINI-RGBD
2. **Pose Processor** (`utils/pose_processor.py`) - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª—é—á–µ–≤—ã—Ö —Ç–æ—á–µ–∫
3. **GPU Autoencoder** (`models/autoencoder_gpu.py`) - LSTM –∞–≤—Ç–æ—ç–Ω–∫–æ–¥–µ—Ä –Ω–∞ GPU
4. **Anomaly Detector** (`models/anomaly_detector.py`) - –î–µ—Ç–µ–∫—Ç–æ—Ä –∞–Ω–æ–º–∞–ª–∏–π
5. **Training Script** (`train_gpu.py`) - –°–∫—Ä–∏–ø—Ç –æ–±—É—á–µ–Ω–∏—è
6. **Inference Pipeline** (`inference_gpu.py`) - –ò–Ω—Ñ–µ—Ä–µ–Ω—Å –¥–ª—è –Ω–æ–≤—ã—Ö –≤–∏–¥–µ–æ

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **GPU —Å CUDA –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π** (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è)
- Python 3.11+
- CUDA 11.8+ (–¥–ª—è PyTorch)

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ PyTorch —Å CUDA** (–≤–∞–∂–Ω–æ!):
   ```bash
   # –î–ª—è CUDA 11.8
   pip install torch torchvision --index-url https://download.pytorch.org/whl/cu118
   
   # –ò–ª–∏ –¥–ª—è CUDA 12.1
   pip install torch torchvision --index-url https://download.pytorch.org/whl/cu121
   ```

2. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**:
   ```bash
   pip install -r requirements.txt
   ```

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ GPU**:
   ```python
   import torch
   print(torch.cuda.is_available())  # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å True
   print(torch.cuda.get_device_name(0))  # –ù–∞–∑–≤–∞–Ω–∏–µ GPU
   ```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–∞—Ç–∞—Å–µ—Ç MINI-RGBD –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ:

```
MINI-RGBD_web/
‚îú‚îÄ‚îÄ 01/
‚îÇ   ‚îî‚îÄ‚îÄ rgb/
‚îÇ       ‚îî‚îÄ‚îÄ syn_*.png
‚îú‚îÄ‚îÄ 02/
‚îÇ   ‚îî‚îÄ‚îÄ rgb/
‚îÇ       ‚îî‚îÄ‚îÄ syn_*.png
...
‚îî‚îÄ‚îÄ 12/
    ‚îî‚îÄ‚îÄ rgb/
        ‚îî‚îÄ‚îÄ syn_*.png
```

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `config.yaml` –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:

```yaml
data:
  mini_rgbd_path: "MINI-RGBD_web"
  train_sequences: [1, 2, 3, 4, 5, 6, 7, 8]
  val_sequences: [9, 10]
  test_sequences: [11, 12]

training:
  device: "cuda"
  batch_size: 32
  num_epochs: 100
  learning_rate: 0.001
  use_amp: true  # Mixed precision
```

### 2. –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

```bash
python train_gpu.py --config config.yaml
```

**–í–∞–∂–Ω–æ**: 
- –û–±—É—á–µ–Ω–∏–µ —Ç—Ä–µ–±—É–µ—Ç GPU
- –ü–æ—Ä–æ–≥ –∞–Ω–æ–º–∞–ª–∏–π –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –¢–û–õ–¨–ö–û –Ω–∞ validation –¥–∞–Ω–Ω—ã—Ö
- Test –¥–∞–Ω–Ω—ã–µ –ù–ï –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—É—á–µ–Ω–∏—è**:
- `checkpoints/best_model.pt` - –ª—É—á—à–∞—è –º–æ–¥–µ–ª—å
- `checkpoints/anomaly_detector.pt` - –¥–µ—Ç–µ–∫—Ç–æ—Ä —Å –ø–æ—Ä–æ–≥–æ–º
- `checkpoints/checkpoint_epoch_*.pt` - –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

### 3. –ò–Ω—Ñ–µ—Ä–µ–Ω—Å –¥–ª—è –Ω–æ–≤—ã—Ö –≤–∏–¥–µ–æ

```bash
python inference_gpu.py \
    --video path/to/video.mp4 \
    --checkpoint checkpoints/best_model.pt \
    --config config.yaml \
    --output inference_results
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞**:
- `inference_results/reconstruction_error.png` - –≥—Ä–∞—Ñ–∏–∫ –æ—à–∏–±–∫–∏ —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
- `inference_results/anomaly_stats.txt` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∞–Ω–æ–º–∞–ª–∏–π

## üîí –ó–∞—â–∏—Ç–∞ –æ—Ç —É—Ç–µ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö

–°–∏—Å—Ç–µ–º–∞ —Å—Ç—Ä–æ–≥–æ —Ä–∞–∑–¥–µ–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—è–º:

- **Train**: –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ 01-08
- **Val**: –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ 09-10
- **Test**: –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ 11-12

**–í–ê–ñ–ù–û**: –ù–∏–∫–∞–∫–∏–µ –∫–∞–¥—Ä—ã –∏–∑ –æ–¥–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ —Ä–∞–∑–Ω—ã–µ –Ω–∞–±–æ—Ä—ã –¥–∞–Ω–Ω—ã—Ö.

## üìä –ú–µ—Ç—Ä–∏–∫–∏

- **Reconstruction Loss (MSE)** - –Ω–∞ validation –¥–∞–Ω–Ω—ã—Ö
- **Anomaly Detection Rate** - –ø—Ä–æ—Ü–µ–Ω—Ç –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã—Ö –∞–Ω–æ–º–∞–ª–∏–π
- **FPS –ø—Ä–∏ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–µ** - —Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏
- **GPU Memory Usage** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ GPU

## üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –û—à–∏–±–∫–∞: "GPU –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω"

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É CUDA:
   ```bash
   nvidia-smi
   ```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ PyTorch:
   ```python
   import torch
   print(torch.cuda.is_available())
   ```

3. –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ PyTorch —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–µ–π CUDA

### –û—à–∏–±–∫–∞: "Out of memory"

–£–º–µ–Ω—å—à–∏—Ç–µ `batch_size` –≤ `config.yaml`:
```yaml
training:
  batch_size: 16  # –≤–º–µ—Å—Ç–æ 32
```

### –û—à–∏–±–∫–∞: "–ù–µ—Ç –≤–∞–ª–∏–¥–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π"

- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç—å –∫ –¥–∞—Ç–∞—Å–µ—Ç—É –≤ `config.yaml`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ RGB –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—Ç
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ MediaPipe –º–æ–∂–µ—Ç –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–∑—É

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤:
- –ö–æ–Ω—Å–æ–ª—å (INFO —É—Ä–æ–≤–µ–Ω—å)
- `logs/training.log` (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ)

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–¥–µ–ª–∏

–í `config.yaml` –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å:

- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: —Ä–∞–∑–º–µ—Ä—ã —Å–∫—Ä—ã—Ç—ã—Ö —Å–ª–æ–µ–≤, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ–µ–≤
- **–û–±—É—á–µ–Ω–∏–µ**: learning rate, batch size, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö
- **–î–µ—Ç–µ–∫—Ü–∏—è**: –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª—å –¥–ª—è –ø–æ—Ä–æ–≥–∞ –∞–Ω–æ–º–∞–ª–∏–π
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–∑—ã**: –¥–ª–∏–Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

- **MINI-RGBD –¥–∞—Ç–∞—Å–µ—Ç**: http://s.fhg.de/mini-rgbd
- **MediaPipe Pose**: https://google.github.io/mediapipe/solutions/pose
- **PyTorch CUDA**: https://pytorch.org/get-started/locally/

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–¢–û–õ–¨–ö–û GPU –æ–±—É—á–µ–Ω–∏–µ** - —Å–∏—Å—Ç–µ–º–∞ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç CPU –æ–±—É—á–µ–Ω–∏–µ
2. **–ù–ï–¢ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è 3D –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç** - —Ç–æ–ª—å–∫–æ RGB –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
3. **–°—Ç—Ä–æ–≥–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö** - –Ω–∏–∫–∞–∫–æ–π –ø–µ—Ä–µ—Ç–∞—Å–æ–≤–∫–∏ –º–µ–∂–¥—É –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—è–º–∏
4. **–ü–æ—Ä–æ–≥ –Ω–∞ validation** - test –¥–∞–Ω–Ω—ã–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–æ—Ä–æ–≥–∞

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–∞—Ç–∞—Å–µ—Ç MINI-RGBD –ø–æ–¥ Creative Commons Attribution-NonCommercial-ShareAlike 4.0 License.

